!function(){function a(){this.array=[[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1]],this.colindex=[0,0,0,0,0,0,0,0]}function b(){for(var a=Game.activegame.array,b=0;7>b;b++)for(var c=0;6>c;c++)if(a[b][c]<0)return!1;return!0}function c(){Game.activegame.array;for(var a=Game.activegame.colindex,b=new Array,c=0;7>c;c++)a[c]<6&&b.push(c);if(b.length<=0)return-1;var d=0|Math.random()*b.length;return b[d]}function d(a){var b,c,d,e=Game.activegame.array,f=Game.activegame.colindex,g=0,h=-1;for(b=0;7>b;b++){for(g=0,c=0;c<f[b];c++)e[b][c]==a?g++:g=0;if(g>2)return console.log("POSSIBLE WIN: player "+a+" column "+(b+1)),b}for(c=0;6>c;c++)for(b=0;4>b;b++){for(g=0,h=-1,d=0;4>d;d++)e[b+d][c]==a?g++:e[b+d][c]<0&&f[b+d]==c&&0>h?(g++,h=b+d):(h=-1,g=0);if(4==g&&h>=0)return console.log("POSSIBLE WIN: player "+a+" column "+(h+1)),h}return-1}function e(){var a=-1;return a=d(Game.activeplayer),a>=0?(n(a,!0),void 0):(a=d((Game.activeplayer+1)%2),a>=0?(n(a,!0),void 0):(a=c(),a>=0?(n(a,!0),void 0):void 0))}function f(a){this.soundobj=new Audio(a),this.isPlaying=!1,this.play=function(){this.isPlaying&&(this.soundobj.pause(),this.soundobj.currentTime=0,this.isPlaying=!1),this.soundobj.play(),this.isPlaying=!0}}function g(a){var b=["#type_onegame","#type_bestofthree","#type_bestoffive"];Game.gametype=a,D.setGameType(a);for(var c=0;3>c;c++)a==c?$(b[c]).addClass("selectedtype"):$(b[c]).removeClass("selectedtype");j()}function h(a,b){if(!(1==a&&Game.playercolor[1]==b||2==a&&Game.playercolor[0]==b)){var c=["#player_player"+a+"orange","#player_player"+a+"red","#player_player"+a+"blue","#player_player"+a+"green"],d=["orangesolid","redsolid","bluesolid","greensolid"];1==a?(Game.playercolor[0]=b,D.setPlayer1Color(b)):(Game.playercolor[1]=b,D.setPlayer2Color(b));for(var e=0;4>e;e++)b==e?$(c[e]).addClass(d[e]):$(c[e]).removeClass(d[e]);i()}}function i(){Game.player1name&&""!=Game.player1name&&Game.player2name&&""!=Game.player2name&&Game.playercolor[0]>=0&&Game.playercolor[0]<4&&Game.playercolor[1]>=0&&Game.playercolor[1]<4?($("#player_nextbutton").removeClass("inactive_button"),$("#player_nextbutton").addClass("active_button")):($("#player_nextbutton").removeClass("active_button"),$("#player_nextbutton").addClass("inactive_button"))}function j(){Game.gametype>=0&&Game.gametype<3?($("#type_startbutton").removeClass("inactive_button"),$("#type_startbutton").addClass("active_button")):($("#type_startbutton").removeClass("active_button"),$("#type_startbutton").addClass("inactive_button"))}function k(){Game.player1name=D.getPlayer1Name()||"Player1",Game.player2name=D.getPlayer2Name()||"Player2";var a=D.getPlayer1Color()||2;h(1,a);var b=D.getPlayer1Color()||3;h(2,b);var c=D.getGameType()||0;g(c)}function l(){Game.ignore_input=!0}function m(){Game.ignore_input=!1}function n(a,b){if(!Game.ignore_input||b===!0){u(a),w();var c=Game.activegame.colindex[a];if(!(c>=6)){var d=["game_piece_orange","game_piece_red","game_piece_blue","game_piece_green"],e=d[Game.playercolor[Game.activeplayer]];Game.activegame.array[a][c]=Game.activeplayer,Game.activegame.colindex[a]++,l(),window.setTimeout("Game.movecomplete()",600),$("#game_grid").append('<div id="game_column'+a+"_row"+c+'" class="game_col'+a+" game_row"+c+" "+e+'"></div>')}}}function o(){$("#game_grid").empty(),Game.activegame=new a,m()}function p(a){var b=Game.playercolor[a],c=["win_banner_orange","win_banner_red","win_banner_blue","win_banner_green"],d=["win_playername_orange","win_playername_red","win_playername_blue","win_playername_green"],e=["win_playagain_orange","win_playagain_red","win_playagain_blue","win_playagain_green"],f=["win_startover_orange","win_startover_red","win_startover_blue","win_startover_green"];0==a?$("#win_playername").text(Game.player1name):$("#win_playername").text(Game.player2name);for(var g=0;4>g;g++)g==b?($("#win_banner").addClass(c[g]),$("#win_playername").addClass(d[g]),$("#win_playagain").addClass(e[g]),$("#win_startover").addClass(f[g])):($("#win_banner").removeClass(c[g]),$("#win_playername").removeClass(d[g]),$("#win_playagain").removeClass(e[g]),$("#win_startover").removeClass(f[g]));$("#game_page").hide(),$("#win_page").show()}function q(){x(),$("#quit_dlg").hide(),$("#game_grid").empty(),Game.activegame=new a,Game.activeplayer=0,Game.playerwins=[0,0],$("#game_player1_wins").text(B[0]),$("#game_player2_wins").text(B[0]),$("#game_player1active").show(),$("#game_player2active").hide(),u(Game.activecolumn),$("#win_page").hide(),$("#game_page").hide(),$("#intro_page").show(),m()}function r(){x(),$("#game_grid").empty(),Game.activegame=new a,Game.activeplayer=0,Game.playerwins=[0,0],$("#game_player1_wins").text(B[0]),$("#game_player2_wins").text(B[0]),$("#game_player1active").show(),$("#game_player2active").hide(),u(Game.activecolumn),$("#win_page").hide(),$("#game_page").show(),m()}function s(a,b,c,d,e,f,g,h,i){Game.playerwins[a]++,y(),$("#game_column"+b+"_row"+c).addClass("game_piece_win1"),$("#game_column"+d+"_row"+e).addClass("game_piece_win2"),$("#game_column"+f+"_row"+g).addClass("game_piece_win3"),$("#game_column"+h+"_row"+i).addClass("game_piece_win4"),$("#game_player"+(a+1)+"_wins").text(B[Game.playerwins[a]]),Game.playerwins[a]>=Game.gametype+1?window.setTimeout("Game.game_over("+a+")",1e3):window.setTimeout("Game.start_new()",1e3)}function t(){var a=Game.activegame.array;Game.activegame.colindex;var c,d,f,g=[0,0];for(v(),c=0;7>c;c++)for(g[0]=0,g[1]=0,d=0;6>d;d++)if(a[c][d]>=0){var h=a[c][d];if(g[h]++,g[(h+1)%2]=0,g[h]>=4)return s(h,c,d-3,c,d-2,c,d-1,c,d),void 0}else g[0]=0,g[1]=0;for(d=0;6>d;d++)for(g[0]=0,g[1]=0,c=0;7>c;c++)if(a[c][d]>=0){var h=a[c][d];if(g[h]++,g[(h+1)%2]=0,g[h]>=4)return s(h,c-3,d,c-2,d,c-1,d,c,d),void 0}else g[0]=0,g[1]=0;var i=[[0,2],[0,1],[0,0],[1,0],[2,0],[3,0]];for(f=0;6>f;f++)for(g[0]=0,g[1]=0,c=i[f][0],d=i[f][1];7>c&&6>d;c++,d++)if(a[c][d]>=0){var h=a[c][d];if(g[h]++,g[(h+1)%2]=0,g[h]>=4)return s(h,c-3,d-3,c-2,d-2,c-1,d-1,c,d),void 0}else g[0]=0,g[1]=0;for(i=[[3,0],[4,0],[5,0],[6,0],[6,1],[6,2]],f=0;6>f;f++)for(g[0]=0,g[1]=0,c=i[f][0],d=i[f][1];c>=0&&6>d;c--,d++)if(a[c][d]>=0){var h=a[c][d];if(g[h]++,g[(h+1)%2]=0,g[h]>=4)return s(h,c+3,d-3,c+2,d-2,c+1,d-1,c,d),void 0}else g[0]=0,g[1]=0;Game.activeplayer=(Game.activeplayer+1)%2,0==Game.activeplayer?($("#game_player1active").show(),$("#game_player2active").hide()):($("#game_player1active").hide(),$("#game_player2active").show()),b()&&o(),Game.computer&&1==Game.activeplayer?e():(u(Game.activecolumn),m())}function u(a){Game.activecolumn=a;var b=["game_piece_orange","game_piece_red","game_piece_blue","game_piece_green"],c=b[Game.playercolor[Game.activeplayer]];$("#game_column_selector").attr("class","game_selcol"+a),$("#game_column_selector").show(),$("#game_column_selector_candy").attr("class","game_col"+a+" "+c),$("#game_column_selector_candy").show()}function v(){Game.move_sound.play()}function w(){Game.menunav_sound.play()}function x(){Game.select_sound.play()}function y(){Game.win_sound.play()}function z(){Game.player1name=$("#player1name").val(),D.setPlayer1Name(Game.player1name),D.save(),i()}function A(){Game.player2name=$("#player2name").val(),D.setPlayer2Name(Game.player2name),D.save(),i()}Game={};var B=["0","1","2","3","4","5"],C=function(){var a={},b="sweetspot_game_data",c={gametype:null,player1Name:null,player2Name:null,player1Color:null,player2Color:null};a.save=function(){var a=JSON.stringify(c);localStorage.setItem(b,a)},a.load=function(){var a=localStorage.getItem(b);a&&(c=JSON.parse(a))};var d=function(a,b){c[a]=b};return a.setGameType=function(a){d("gametype",a)},a.getGameType=function(){return c.gametype},a.setPlayer1Color=function(a){d("player1Color",a)},a.setPlayer2Color=function(a){d("player2Color",a)},a.getPlayer1Color=function(){return c.player1Color},a.getPlayer2Color=function(){return c.player2Color},a.setPlayer1Name=function(a){d("player1Name",a)},a.setPlayer2Name=function(a){d("player2Name",a)},a.getPlayer1Name=function(){return c.player1Name},a.getPlayer2Name=function(){return c.player2Name},a},D=C();D.load();var E=function(){$("#intro_playbutton").text(chrome.i18n.getMessage("play")),$("#player_player1_static").text(chrome.i18n.getMessage("player1")),$("#player_player2_static").text(chrome.i18n.getMessage("player2")),$("#player_text_chooseyour").text(chrome.i18n.getMessage("chooseyour")),$("#player_text_color").text(chrome.i18n.getMessage("color")),$("#player_nextbutton").text(chrome.i18n.getMessage("next")),$("#type_onegame_text").text(chrome.i18n.getMessage("1game")),$("#type_bestofthree_text").text(chrome.i18n.getMessage("2game")),$("#type_bestoffive_text").text(chrome.i18n.getMessage("3game")),$("#type_startbutton").text(chrome.i18n.getMessage("start")),$("#quit_dlg_img").text(chrome.i18n.getMessage("startoverquestion")),$("#quit_dlg_no").text(chrome.i18n.getMessage("no")),$("#quit_dlg_yes").text(chrome.i18n.getMessage("yes")),$("#win_banner").text(chrome.i18n.getMessage("winner")),$("#win_playagain_text").text(chrome.i18n.getMessage("playagain")),$("#win_startover_text").text(chrome.i18n.getMessage("startover")),B[0]=chrome.i18n.getMessage("num0"),B[1]=chrome.i18n.getMessage("num1"),B[2]=chrome.i18n.getMessage("num2"),B[3]=chrome.i18n.getMessage("num3"),B[4]=chrome.i18n.getMessage("num4"),B[5]=chrome.i18n.getMessage("num5")},F=function(){$("[data-drop]").each(function(){var a=$(this).attr("data-drop");$(this).addClass("drop").addClass(a)})},G=function(){$("#player1name").val(Game.player1name),$("#player2name").val(Game.player2name),$("#players_page").delegate(".pick","mousedown",function(a){var b=$(a.target);w();var c=parseInt(b.attr("data-player")),d=parseInt(b.attr("data-color"));h(c,d)});var a=document.getElementById("player1name"),b=document.getElementById("player2name");a.onkeyup=z,b.onkeyup=A,a.onblur=z,b.onblur=A,a.onchange=z,b.onchange=A,$("#player_nextbutton").click(function(){$("#player_nextbutton").hasClass("active_button")&&(x(),$("#players_page").hide(),$("#type_page").show())})},H=function(){$("#type_startbutton").click(function(){if($("#type_startbutton").hasClass("active_button")){x(),u(Game.activecolumn);for(var a=["game_player1orange","game_player1red","game_player1blue","game_player1green"],b=["game_player2orange","game_player2red","game_player2blue","game_player2green"],c=0;4>c;c++){var d=Game.playercolor[0],e=Game.playercolor[1];c==d?$("#game_player1marquee").addClass(a[c]):$("#game_player1marquee").removeClass(a[c]),c==e?$("#game_player2marquee").addClass(b[c]):$("#game_player2marquee").removeClass(b[c])}$("#game_player1name").text(Game.player1name),$("#game_player2name").text(Game.player2name),$("#type_page").hide(),$("#game_page").show()}}),$("#type_onegame").on("mousedown",function(){w(),g(0)}),$("#type_bestofthree").on("mousedown",function(){w(),g(1)}),$("#type_bestoffive").on("mousedown",function(){w(),g(2)})},I=function(){$("#game_column1").on("mousedown",function(){n(0)}),$("#game_column2").on("mousedown",function(){n(1)}),$("#game_column3").on("mousedown",function(){n(2)}),$("#game_column4").on("mousedown",function(){n(3)}),$("#game_column5").on("mousedown",function(){n(4)}),$("#game_column6").on("mousedown",function(){n(5)}),$("#game_column7").on("mousedown",function(){n(6)}),$("#game_column1").on("mouseover",function(){u(0)}),$("#game_column2").on("mouseover",function(){u(1)}),$("#game_column3").on("mouseover",function(){u(2)}),$("#game_column4").on("mouseover",function(){u(3)}),$("#game_column5").on("mouseover",function(){u(4)}),$("#game_column6").on("mouseover",function(){u(5)}),$("#game_column7").on("mouseover",function(){u(6)}),$("#game_quit").click(function(){$("#quit_dlg").show()}),$("#quit_dlg_no").click(function(){$("#quit_dlg").hide()}),$("#quit_dlg_yes").click(function(){q()}),$("#win_playagain_text").click(function(){r()}),$("#win_startover_text").click(function(){q()})};Game.select_sound=new f("audio/Select.ogg"),Game.move_sound=new f("audio/GamePiece.ogg"),Game.menunav_sound=new f("audio/MenuNavigation.ogg"),Game.win_sound=new f("audio/Winner.ogg"),Game.player1name="",Game.player2name="",Game.computer=!1,Game.playercolor=[-1,-1],Game.gametype=-1,Game.activegame=new a,Game.activecolumn=0,Game.activeplayer=0,Game.playerwins=[0,0],Game.ignore_input=!1,Game.movecomplete=t,Game.game_over=p,Game.start_new=o,window.chrome&&window.chrome.i18n&&E(),k(),F(),G(),H(),I(),D.save(),$("#intro_playbutton").click(function(){x(),$("#intro_page").hide(),$("#players_page").show()})}();